<div class="container-fluid">
  <div class="page-header">
    <div class="row  mt-3">
      <div class="col-md-7">
        <span class="backnavIcon" [routerLink]="['/homepage']">
          <i class="fa fa-angle-left" aria-hidden="true"></i>
        </span>
        <h4 class="text-orange">Repair Mandate</h4>
      </div>
      <div class="col-md-5 text-right small align-self-end createIcons">
        <div class="row">
          <div class="col-5">
            <!-- <mat-form-field>
                              <input matInput placeholder="Product" type="text" name="Product"  />
                            </mat-form-field> -->

            <!-- *ngIf="isValid;else other_content" -->
            <!-- <mat-form-field>

              <mat-select placeholder="Product" id="productlist" [(ngModel)]="productType"  (change)="onKeyForProduct($event)" >
                <mat-option *ngFor="let type of productDetails?.data" [value]="type.productName">
                  {{ type.productName }}
                </mat-option>
              </mat-select>
            </mat-form-field> -->


          </div>
          <div class="col-3 ml-auto">
            <i class="fa fa-floppy-o" aria-hidden="true"></i>
            <i class="fa fa-print"></i>
            <i class="fa fa-times"></i>
          </div>
        </div>
      </div>
    </div>
  </div>



  <div class="createMandateSec">
    <form [formGroup]="repairForm">
      <div class="row">
        <div class="col-7 pr-0">
          <mat-card class="bg-grey">
            <div class="imageBlock" [hidden]="ImageUrl">
              <div class="row text-center">
                <div class="col-12">
                  <div class="image-upload">
                    <label for="file-input" id="mndUpload">
                      <img src="assets/images/upload.png" id="mndUploadImg" class="img-responsive" width="70">
                    </label>
                    <input id="file-input" type="file" (change)="onFileSelected($event)" formControlName="uploadedImage" />
                  </div>

                  <h5 class="mt-2">Upload Mandate</h5>
                  <p>Maximum File size 1mb</p>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-12 text-center">
                  <h4>Only JPG and JPEG is allowed with size of max 100kb and max resolution of 300 DPI</h4>
                </div>
              </div>
            </div>
            <div class="icon-bar">
              <a href="#" class="facebook">
                <i class="fa fa-plus" aria-hidden="true"></i>
              </a>
              <a href="#" class="twitter">
                <i class="fa fa-search-plus"></i>
              </a>
              <a href="#" class="google">
                <i class="fa fa-arrows-alt" aria-hidden="true"></i>
              </a>
              <a href="#" class="linkedin">
                <i class="fa fa-crop"></i>
              </a>
              <i class="fas fa-redo"></i>
              <a href="#" class="youtube">
                <i class="fa fa-minus"></i>
              </a>
            </div>
            <div class="scrollbarHeight">
                <label for="file-input" id="mndUpload">
                    <img [src]="ImageUrl" id="image" class="img-fluid">
                </label>
              <input [hidden]="ImageUrl" id="file-input" type="file" (change)="onFileSelected($event)" formControlName="uploadedImage" />
            </div>
          </mat-card>
          <div class="row">
            <div class="col-12">
              <div class="image-upload pl-3">
                <label for="file-input">
                  <div class="thumbnailImg"></div>
                  <p>+ Attachment</p>
                </label>
                <input id="file-input" type="file" />
              </div>
            </div>
          </div>
        </div>
        <div class="col-5 pl-0">
          <mat-card class="formBlock">
            <div>

              <div class="row">
                <div class="col-6">
                  <mat-form-field>
                    <input matInput placeholder="UMRN" id="umrn" formControlName="umrn" value="{{mandateTorepair?.umrn}}" readonly>
                  </mat-form-field>
                  <mat-form-field>
                    <input matInput placeholder="Sponsoring Bank Code" value="{{mandateTorepair?.sponsorBankCode}}" formControlName="sponsorBankCode"
                       [value]="repairForm.sponsorBankCode" [readonly]="fromAmmend || fromCancel">
                  </mat-form-field>

                  <mat-form-field>
                    <input matInput placeholder="Bank Account Number" value="{{mandateTorepair?.payerAccNum}}" formControlName="payerAccNum"
                      id="payerAccNo" [readonly]="fromAmmend || fromCancel">
                  </mat-form-field>
                </div>

                <div class="col-6">

                  <mat-form-field>
                    <input matInput [matDatepicker]="picker" placeholder="Date" id="createdDate" [min]="minDate" formControlName="createdDate"
                    [readonly]="fromAmmend || fromCancel" >
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                  </mat-form-field>

                  <mat-form-field>
                    <input matInput placeholder="Utility Code" value="{{mandateTorepair?.utilityCode}}" id="utilityCode" formControlName="utilityCode"
                      [value]="repairForm.utilityCode" [readonly]="fromAmmend || fromCancel">
                  </mat-form-field>
                  <mat-form-field>
                    <mat-select placeholder="Account Type" id="accType" value="{{mandateTorepair?.payerAccType}}" formControlName="payerAccType"
                    [disabled]="fromCancel" >
                      <mat-option *ngFor="let type of accountType" [value]="type.value">
                        {{ type.viewValue }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-6">
                  <mat-form-field>
                    <input matInput placeholder="Destination bank code(IFSC/MICR)" value="{{mandateTorepair?.payerBankCode}}" 
                      id="payeeBankCode" formControlName="payerBankCode" [readonly]="fromAmmend || fromCancel">
                  </mat-form-field>

                </div>
                <div class="col-3">
                  <mat-form-field>
                    <input matInput placeholder="Amount" formControlName="amt"
                    [readonly]="fromCancel" value="{{mandateTorepair?.maxAmount}}" id="amt" >

                  </mat-form-field>
                  <!-- <input matInput placeholder="Amount" formControlName="amt" > -->

                  <!-- <span>{{amtErr}}</span> -->
                </div>
                <div class="col-3">
                  <mat-form-field >
                    <mat-select placeholder="Debit Type" id="amountType" 
                     value="{{mandateToRepair?.amountType}}" [disabled]="fromCancel" formControlName="amountType">
                      <mat-option *ngFor="let type of amountTypes"  [value]="type.value">
                        {{ type.viewValue }}
                      </mat-option>
                    </mat-select>

                  </mat-form-field>
                </div>
              </div>

              <div class="row">
                <div class="col-3">
                  <mat-form-field>
                    <mat-select placeholder="Frequency" id="frequency" [disabled]="fromCancel"
                     value="{{mandateToRepair?.mandateFrequency}}" formControlName="mandateFrequency" >
                      <mat-option *ngFor="let frq of frequencies" [value]="frq.value">
                        {{ frq.viewValue }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col-3">
                  <mat-form-field>
                    <input matInput [matDatepicker]="picker1" placeholder="Starting from" 
                    value="{{mandateToRepair?.startDate}}" id="startingFrom" 
                    [readonly]="fromCancel" (ngModelChange)="startDateChanged($event)"
                      [min]="minDate" [max]="startingDate" formControlName="startDate" >
                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                    <mat-datepicker id="startDate" #picker1></mat-datepicker>
                  </mat-form-field>

                </div>
                <div class="col-3">
                  <mat-form-field>
                    <input matInput [matDatepicker]="picker2" placeholder="Upto" 
                    [readonly]="fromCancel" id="upto" (ngModelChange)="endDateChanged($event)" [min]="endingDate"
                      formControlName="endDate" [disabled]="endDateDisabled">
                    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                    <mat-datepicker #picker2></mat-datepicker>
                  </mat-form-field>

                </div>
                <div class="col-3">
                  <mat-checkbox [disabled]="disableUpto" (change)="untillCancelClicked($event)" id="untilCancel" [checked]="checkBoxValue">Until Cancel</mat-checkbox>
                </div>
              </div>

              <div class="row">
                <div class="col-6">
                  <mat-form-field>
                    <input matInput placeholder="Consumer reference number 1" 
                    [readonly]="fromCancel" id="consumerRefNo" formControlName="consumerRefNo" value="{{mandateTorepair?.consumerRefNo}}">
                  </mat-form-field>

                  <mat-form-field>
                    <input matInput placeholder="Scheme plan reference number" 
                    [readonly]="fromCancel" id="schemeReference" formControlName="schemeRefNo" value="{{mandateTorepair?.schemeRefNo}}">
                  </mat-form-field>

                </div>
                <div class="col-6">
                  <mat-form-field>
                    <input matInput placeholder="Mobile Number" formControlName="payerMobileNo" 
                    [readonly]="fromCancel" id="mobileNumber" value="{{mandateTorepair?.payerMobileNo}}">
                  </mat-form-field>


                  <mat-form-field>
                    <input matInput placeholder="Mail Id" formControlName="payerEmail" 
                    [readonly]="fromCancel" id="emailAddress" value="{{mandateTorepair?.payerEmail}}">
                  </mat-form-field>

                </div>
              </div>

              <div class="row">
                <div class="col-12">
                  <mat-form-field>
                    <input matInput placeholder="Name of Account Holder" 
                    [readonly]="fromCancel" id="payerName" formControlName="payerName" value="{{mandateTorepair?.payerName}}">
                  </mat-form-field>

                </div>
              </div>

              <div class="row">
                <div class="col-6">
                  <mat-form-field>
                    <input matInput placeholder="Customer Additional Identifiaction"
                    [readonly]="fromCancel"  id="customerAdditionalIdentification" formControlName="custAddId" value="{{mandateTorepair?.custAddId}}">
                  </mat-form-field>
                </div>
              </div>



              <div class="row text-center">
                <div class="col-12">
                  <span class="error_msg" id="errcustomerAdditionalIdentification">{{errorMsg}}</span>
                </div>
              </div>

              <mat-form-field *ngIf="mandateTorepair.mndTxnCode==='SINGLE_AMEND_ACH'">
                <mat-select placeholder="Amendment Reason" id="Reason"  formControlName="reason" value="{{mandateTorepair?.reason}}" >
                  <mat-option *ngFor="let frq of Reason" [value]="frq.value" required>
                    {{ frq.viewValue }}
                  </mat-option>
                </mat-select>
              </mat-form-field>


              <mat-form-field *ngIf="mandateTorepair.mndTxnCode==='SINGLE_CANCEL_ACH'">
                <mat-select placeholder="Reason for Cancellation" id="Reason" value="{{mandateTorepair?.reason}}"  formControlName="reason"  >
                  <mat-option *ngFor="let frq of cancelReason" [value]="frq.value" required>
                    {{ frq.viewValue }}
                  </mat-option>
                </mat-select>
              </mat-form-field>



              <div class="row text-center">
                <div class="col-12">
                  <span class="error_msg" id="imageErrMsg">{{errorMsg}}</span>
                </div>
              </div>

              <div class="row text-center">
                <div class="col-12">
                  <span id="errorSubmitPopup" matTooltip="{{repairForm.invalid ? 'Please fill all mandatory fields' : ''}}">
                    <button type="submit" value="submit" id="submit" (click)="ngSubmit(repairForm.value)"
                      class="btn btn-default btn-common">Repair Mandate</button>
                  </span>
                  <button class="btn btn-default clearBtn ml-2" id="clear" (click)="clear(repairForm.value)">Close</button>
                </div>
              </div>
            </div>
          </mat-card>
        </div>
      </div>
    </form>

  </div>


</div>
